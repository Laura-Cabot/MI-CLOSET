<div class="p-6 md:p-8 bg-white min-h-screen font-inter">
  <!-- Encabezado -->
  <header class="mb-8 text-center">
    <h1 class="text-3xl font-extrabold text-gray-800 tracking-tight mb-2">CatÃ¡logo de Productos</h1>
    <p class="text-gray-500">Explora nuestra colecciÃ³n.</p>
  </header>

  <!-- Listado de Productos -->
  <section>
    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
      @for (product of paginatedProducts(); track product.id) {
      <div
        class="w-full bg-white border border-gray-200 rounded-lg shadow-md overflow-hidden hover:shadow-lg transition"
      >
        <!-- Imagen -->
        <div class="aspect-[4/5] bg-gray-100 flex items-center justify-center overflow-hidden">
          <img [src]="product.image" [alt]="product.name" class="w-full h-full object-cover" />
        </div>

        <!-- Contenido -->
        <div class="p-3 flex flex-col text-sm">
          <span class="text-[10px] font-semibold uppercase tracking-wider text-rose-500 block mb-1">
            {{ product.category }}
          </span>
          <h3 class="text-base font-semibold text-gray-800 mb-1 truncate">{{ product.name }}</h3>
          <p class="text-lg font-bold text-rose-600 mb-3">
            {{ product.price | currency : 'USD' : 'symbol' : '1.2-2' }}
          </p>

          <!-- BotÃ³n Ver mÃ¡s -->
          <button
            (click)="openModal(product)"
            class="w-full py-2 rounded-md bg-rose-400 text-white font-semibold text-sm hover:bg-rose-500 transition"
          >
            Ver mÃ¡s
          </button>
        </div>
      </div>
      }
    </div>
  </section>

  <!-- BotÃ³n Volver al CatÃ¡logo Completo -->
  <div class="flex justify-center mt-8">
    <button
      (click)="clearFilters()"
      class="px-6 py-2 bg-rose-500 text-white font-semibold rounded-lg shadow hover:bg-rose-600 transition"
    >
      Volver al CatÃ¡logo Completo
    </button>
  </div>

  <!-- Paginado -->
  <div class="flex justify-center items-center mt-6 space-x-1 text-sm">
    <button
      (click)="prevPage()"
      [disabled]="currentPage() === 1"
      class="px-2 py-1 rounded bg-rose-400 text-white disabled:opacity-50 hover:bg-rose-500 transition"
    >
      Â«
    </button>
    <button
      *ngFor="let page of [].constructor(totalPages()); let i = index"
      (click)="goToPage(i + 1)"
      [ngClass]="{
        'bg-rose-400 text-white': currentPage() === i + 1,
        'bg-white text-rose-500 border border-rose-300 hover:bg-rose-50': currentPage() !== i + 1
      }"
      class="px-2 py-1 rounded transition"
    >
      {{ i + 1 }}
    </button>
    <button
      (click)="nextPage()"
      [disabled]="currentPage() === totalPages()"
      class="px-2 py-1 rounded bg-rose-400 text-white disabled:opacity-50 hover:bg-rose-500 transition"
    >
      Â»
    </button>
  </div>

  <!-- ðŸŸ¢ Modal con ficha completa -->
  <div
    *ngIf="showModal"
    class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"
  >
    <div class="bg-white rounded-lg max-w-md w-full p-6 relative">
      <button
        (click)="closeModal()"
        class="absolute top-2 right-2 text-gray-500 hover:text-gray-800"
      >
        âœ•
      </button>
      <img
        *ngIf="selectedProduct"
        [src]="selectedProduct.image"
        [alt]="selectedProduct.name"
        class="w-full h-64 object-cover rounded mb-4"
      />
      <h2 class="text-xl font-bold mb-2">{{ selectedProduct?.name }}</h2>
      <p class="text-gray-600 mb-4">{{ selectedProduct?.description }}</p>
      <p class="text-lg font-semibold text-rose-500 mb-4">
        {{ selectedProduct?.price | currency : 'USD' : 'symbol' : '1.2-2' }}
      </p>

      <!-- Tallas -->
      <div class="mb-3" *ngIf="selectedProduct?.isApparel && selectedProduct">
        <label class="block text-xs font-medium text-gray-600 mb-1">Talla:</label>
        <div class="flex flex-wrap gap-1">
          <button
            *ngFor="let size of selectedProduct.sizes"
            (click)="selectSize(selectedProduct!.id, size)"
            [disabled]="selectedProduct.stock === 0"
            [ngClass]="{
              'bg-rose-400 text-white shadow':
                selectedOptions[selectedProduct!.id]?.size === size && selectedProduct.stock > 0,
              'bg-gray-200 text-gray-400 line-through cursor-not-allowed':
                selectedProduct.stock === 0,
              'bg-gray-100 text-gray-700 border border-gray-300 hover:bg-rose-100':
                selectedOptions[selectedProduct!.id]?.size !== size && selectedProduct.stock > 0
            }"
            class="w-7 h-7 flex items-center justify-center text-[10px] font-semibold rounded-full transition"
          >
            {{ size }}
          </button>
        </div>
      </div>

      <!-- Colores -->
      <div class="mb-3" *ngIf="selectedProduct">
        <label class="block text-xs font-medium text-gray-600 mb-1">Color:</label>
        <div class="flex flex-wrap gap-1">
          <button
            *ngFor="let color of selectedProduct.colors"
            (click)="selectColor(selectedProduct!.id, color)"
            [disabled]="selectedProduct.stock === 0"
            [ngClass]="{
              'ring-2 ring-offset-1 ring-rose-400':
                selectedOptions[selectedProduct!.id]?.color === color && selectedProduct.stock > 0,
              'opacity-40 cursor-not-allowed': selectedProduct.stock === 0
            }"
            [style.backgroundColor]="colorMap[color] || colorMap['default']"
            class="w-5 h-5 rounded-full border border-gray-300 transition"
            [title]="color"
          ></button>
        </div>
      </div>

      <!-- BotÃ³n AÃ±adir al Carrito -->
      <button
        (click)="addToCart(selectedProduct!)"
        [disabled]="!canAddToCart(selectedProduct!)"
        [ngClass]="{
          'bg-rose-400 text-white hover:bg-rose-500': canAddToCart(selectedProduct!),
          'bg-rose-100 text-rose-400 cursor-not-allowed': !canAddToCart(selectedProduct!)
        }"
        class="w-full py-2 rounded-md font-semibold text-sm focus:outline-none focus:ring-2 focus:ring-rose-200 transition"
      >
        {{ canAddToCart(selectedProduct!) ? 'AÃ±adir al Carrito' : 'Selecciona opciones' }}
      </button>
    </div>
  </div>
</div>
